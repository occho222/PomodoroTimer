<Window x:Class="PomodoroTimer.Views.QuickTemplateManagerDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†" 
        Height="600" Width="800"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize">
    
    <Window.Resources>
        <Style TargetType="Button" x:Key="ActionButton">
            <Setter Property="Background" Value="#3B82F6"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Margin" Value="5,2"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2563EB"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style TargetType="Button" x:Key="DeleteButton" BasedOn="{StaticResource ActionButton}">
            <Setter Property="Background" Value="#EF4444"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#DC2626"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†" FontSize="24" FontWeight="Bold" Margin="0,0,0,10"/>
            <TextBlock Text="ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ä½œæˆã§ãã‚‹ã‚¿ã‚¹ã‚¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç®¡ç†ã—ã¾ã™" FontSize="14" Foreground="Gray"/>
        </StackPanel>
        
        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªã‚¹ãƒˆ -->
            <GroupBox Grid.Column="0" Header="ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§" Margin="0,0,20,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="âž• æ–°è¦ä½œæˆ" Style="{StaticResource ActionButton}"
                                Command="{Binding AddNewTemplateCommand}"/>
                        <Button Content="ðŸ“ ç·¨é›†" Style="{StaticResource ActionButton}"
                                Command="{Binding EditSelectedTemplateCommand}"
                                IsEnabled="{Binding SelectedTemplate, Converter={StaticResource NotNullToBooleanConverter}}"/>
                        <Button Content="ðŸ—‘ï¸ å‰Šé™¤" Style="{StaticResource DeleteButton}"
                                Command="{Binding DeleteSelectedTemplateCommand}"
                                IsEnabled="{Binding SelectedTemplate, Converter={StaticResource NotNullToBooleanConverter}}"/>
                    </StackPanel>
                    
                    <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªã‚¹ãƒˆ -->
                    <DataGrid Grid.Row="1" ItemsSource="{Binding Templates}" 
                              SelectedItem="{Binding SelectedTemplate}"
                              AutoGenerateColumns="False" IsReadOnly="True"
                              GridLinesVisibility="Horizontal" HeadersVisibility="Column">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="è¡¨ç¤ºå" Binding="{Binding DisplayName}" Width="150"/>
                            <DataGridTextColumn Header="ã‚«ãƒ†ã‚´ãƒª" Binding="{Binding Category}" Width="120"/>
                            <DataGridTextColumn Header="äºˆæƒ³æ™‚é–“" Width="80">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0}åˆ†">
                                        <Binding Path="EstimatedMinutes"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="å„ªå…ˆåº¦" Binding="{Binding Priority}" Width="80"/>
                        </DataGrid.Columns>
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Setter Property="Height" Value="35"/>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#F8F9FA"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                    </DataGrid>
                </Grid>
            </GroupBox>
            
            <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
            <GroupBox Grid.Column="1" Header="ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel DataContext="{Binding SelectedTemplate}">
                        <TextBlock Text="é¸æŠžã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ" FontWeight="Bold" Margin="0,0,0,10"/>
                        
                        <StackPanel Visibility="{Binding Converter={StaticResource NotNullToVisibilityConverter}}">
                            <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæƒ…å ± -->
                            <Border Background="{Binding BackgroundBrush}" Padding="15" Margin="0,0,0,15" CornerRadius="8">
                                <TextBlock Text="{Binding DisplayName}" Foreground="White" FontWeight="Bold" FontSize="16"/>
                            </Border>
                            
                            <TextBlock Text="ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒˆãƒ«:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <TextBlock Text="{Binding TaskTitle}" TextWrapping="Wrap" Margin="0,0,0,10"/>
                            
                            <TextBlock Text="ã‚¿ã‚¹ã‚¯èª¬æ˜Ž:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <TextBlock Text="{Binding TaskDescription}" TextWrapping="Wrap" Margin="0,0,0,10"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="ã‚«ãƒ†ã‚´ãƒª:" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <TextBlock Text="{Binding Category}" Margin="0,0,0,10"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="å„ªå…ˆåº¦:" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <TextBlock Text="{Binding Priority}" Margin="0,0,0,10"/>
                                </StackPanel>
                            </Grid>
                            
                            <TextBlock Text="äºˆæƒ³æ™‚é–“:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <TextBlock Margin="0,0,0,10">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0}åˆ†">
                                        <Binding Path="EstimatedMinutes"/>
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            
                            <TextBlock Text="ã‚¿ã‚°:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <ItemsControl ItemsSource="{Binding Tags}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#E5E7EB" Padding="6,3" Margin="2" CornerRadius="12">
                                            <TextBlock Text="{Binding}" FontSize="12"/>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            
                            <!-- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ -->
                            <TextBlock Text="ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ:" FontWeight="Bold" Margin="0,15,0,5"
                                       Visibility="{Binding DefaultChecklist.Count, Converter={StaticResource CountToVisibilityConverter}}"/>
                            <ItemsControl ItemsSource="{Binding DefaultChecklist}"
                                          Visibility="{Binding DefaultChecklist.Count, Converter={StaticResource CountToVisibilityConverter}}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Margin="0,2">
                                            <CheckBox IsChecked="{Binding IsChecked}" IsEnabled="False" Margin="0,0,8,0"/>
                                            <TextBlock Text="{Binding Text}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                        
                        <TextBlock Text="ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠžã—ã¦ãã ã•ã„" Foreground="Gray" FontStyle="Italic"
                                   Visibility="{Binding Converter={StaticResource NullToVisibilityConverter}}"/>
                    </StackPanel>
                </ScrollViewer>
            </GroupBox>
        </Grid>
        
        <!-- ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button Content="ã‚¤ãƒ³ãƒãƒ¼ãƒˆ" Style="{StaticResource ActionButton}"
                    Command="{Binding ImportTemplatesCommand}"/>
            <Button Content="ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ" Style="{StaticResource ActionButton}"
                    Command="{Binding ExportTemplatesCommand}"/>
            <Button Content="é–‰ã˜ã‚‹" Style="{StaticResource ActionButton}"
                    Command="{Binding CloseCommand}" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>